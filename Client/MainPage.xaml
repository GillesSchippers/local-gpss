<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="GPSS_Client.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    BackgroundColor="{DynamicResource PageBackgroundColor}">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Check Legality" Clicked="OnCheckLegalityClicked" Order="Primary" Priority="1" />
        <ToolbarItem Text="Legalize" Clicked="OnLegalizePokemonClicked" Order="Primary" Priority="2" />
        <ToolbarItem Text="Upload" Clicked="OnUploadPokemonClicked" Order="Primary" Priority="3" />
    </ContentPage.ToolbarItems>

    <ScrollView>
        <VerticalStackLayout Spacing="16" Padding="24,36,24,24">

            <Frame Padding="12" CornerRadius="12" BackgroundColor="{DynamicResource CardBackgroundColor}">
                <VerticalStackLayout Spacing="8">
                    <CollectionView x:Name="ResultsView" HeightRequest="300" SelectionMode="Multiple" SelectionChanged="OnResultsSelectionChanged">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame Padding="8" Margin="4" CornerRadius="8" BackgroundColor="{DynamicResource CardBackgroundColor}">
                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer NumberOfTapsRequired="1"
                                            Command="{Binding Source={x:Reference MainPage}, Path=ShowDownloadMenuCommand}"
                                            CommandParameter="{Binding .}" />
                                    </Frame.GestureRecognizers>
                                    <VerticalStackLayout Spacing="8">
                                        <!-- Top: Nickname and Legal -->
                                        <HorizontalStackLayout Spacing="12">
                                            <Label Text="{Binding Nickname}" FontAttributes="Bold" FontSize="18"/>
                                            <Label Text="{Binding Legal, StringFormat='Legal: {0}'}" FontSize="14"/>
                                        </HorizontalStackLayout>
                                        <!-- OT and IDs -->
                                        <HorizontalStackLayout Spacing="12">
                                            <Label Text="{Binding OT, StringFormat='OT: {0}'}" FontSize="14"/>
                                            <Label Text="{Binding SID, StringFormat='SID: {0}'}" FontSize="14"/>
                                            <Label Text="{Binding TID, StringFormat='TID: {0}'}" FontSize="14"/>
                                        </HorizontalStackLayout>
                                        <!-- Details -->
                                        <HorizontalStackLayout Spacing="12">
                                            <Label Text="{Binding Species, StringFormat='Species: {0}'}" FontSize="14"/>
                                            <Label Text="{Binding Level, StringFormat='Lv. {0}'}" FontSize="14"/>
                                            <Label Text="{Binding IsShiny, StringFormat='Shiny: {0}'}" FontSize="14"/>
                                        </HorizontalStackLayout>
                                        <!-- Generation -->
                                        <HorizontalStackLayout Spacing="12">
                                            <Label Text="{Binding Generation, StringFormat='Gen: {0}'}" FontSize="14"/>
                                        </HorizontalStackLayout>
                                    </VerticalStackLayout>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                    <HorizontalStackLayout Spacing="8" HorizontalOptions="Center">
                        <Button Text="Previous" Clicked="OnPreviousPageClicked" />
                        <Label x:Name="PageLabel" Text="Page 1" VerticalOptions="Center" />
                        <Button Text="Next" Clicked="OnNextPageClicked" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
